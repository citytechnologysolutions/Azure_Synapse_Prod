{
	"name": "OPS F_Waybill SoR - STOPS",
	"properties": {
		"folder": {
			"name": "Archive/Old Notebooks"
		},
		"content": {
			"query": "IF NOT EXISTS (SELECT * FROM sys.external_file_formats WHERE name = 'SynapseParquetFormat') \n\tCREATE EXTERNAL FILE FORMAT [SynapseParquetFormat] \n\tWITH ( FORMAT_TYPE = PARQUET)\nGO\n\nIF NOT EXISTS (SELECT * FROM sys.external_data_sources WHERE name = 'synapse_citylogisticsstorage_dfs_core_windows_net') \n\tCREATE EXTERNAL DATA SOURCE [synapse_citylogisticsstorage_dfs_core_windows_net] \n\tWITH (\n\t\tLOCATION = 'abfss://synapse@citylogisticsstorage.dfs.core.windows.net' \n\t)\nGO\n\nCREATE EXTERNAL TABLE F_Waybill (\n\t[ER_WaybillID] int,\n\t[WB_DDate] date,\n\t[WB_DDateTime] datetime2(7),\n\t[WB_DeBriefDt] datetime2(7),\n\t[WB_DeBriefed] int,\n\t[WB_DelayReason] nvarchar(4000),\n\t[WB_DeliveryStatus] nvarchar(4000),\n\t[WB_ID] int,\n\t[WB_InService] datetime2(7),\n\t[WB_InServiceReason] nvarchar(4000),\n\t[WB_InServiceReasonGroup] nvarchar(4000),\n\t[WB_LoadID] int,\n\t[WB_NotDebriefedReason] nvarchar(4000),\n\t[WB_ReasonDetail] nvarchar(4000),\n\t[WB_ReasonDetailID] int,\n\t[WB_ReasonGroup] nvarchar(4000),\n\t[WB_ReasonGroupID] int,\n\t[WB_PODDate] date,\n\t[WB_PODDateTime] datetime2(7),\n\t[WB_pod.id] bigint,\n\t[WB_pod.name] nvarchar(4000),\n\t[WB_pod.poddate] bigint,\n\t[WB_pod.geopoint] nvarchar(4000),\n\t[WB_pod.lat] float,\n\t[WB_pod.lng] float,\n\t[WB_pod.customerrating] int,\n\t[WB_pod.customerfeedback] nvarchar(4000),\n\t[WB_delivery.actualeta] nvarchar(4000),\n\t[WB_delivery.address] nvarchar(4000),\n\t[WB_delivery.aid] bigint,\n\t[WB_delivery.altered] int,\n\t[WB_delivery.approximated] int,\n\t[WB_delivery.billingcustid] bigint,\n\t[WB_delivery.chepslip] int,\n\t[WB_delivery.cleandelivery] int,\n\t[WB_delivery.comebacklater] bigint,\n\t[WB_delivery.country] nvarchar(4000),\n\t[WB_delivery.customerdn] int,\n\t[WB_delivery.customerid] bigint,\n\t[WB_delivery.customerinvoice] int,\n\t[WB_delivery.customorder] int,\n\t[WB_delivery.debriefed] int,\n\t[WB_delivery.debriefmode] nvarchar(4000),\n\t[WB_delivery.delegatedate] bigint,\n\t[WB_delivery.delegatemode] nvarchar(4000),\n\t[WB_delivery.deliverbydate] date,\n\t[WB_delivery.deliverbydatetime] nvarchar(4000),\n\t[WB_delivery.deliverbytime] nvarchar(4000),\n\t[WB_delivery.deliverydate] nvarchar(4000),\n\t[WB_delivery.deliverydatetime] nvarchar(4000),\n\t[WB_delivery.deliveryorder] int,\n\t[WB_delivery.deliverytime] nvarchar(4000),\n\t[WB_delivery.dispatch.id] bigint,\n\t[WB_delivery.drivernote] nvarchar(4000),\n\t[WB_delivery.eta] nvarchar(4000),\n\t[WB_delivery.geocodingstatus] nvarchar(4000),\n\t[WB_delivery.geopoint] nvarchar(4000),\n\t[WB_delivery.grv] nvarchar(4000),\n\t[WB_delivery.id] bigint,\n\t[WB_delivery.insdate] bigint,\n\t[WB_delivery.lastregioncrossed] nvarchar(4000),\n\t[WB_delivery.lat] float,\n\t[WB_delivery.lmsdebriefed] int,\n\t[WB_delivery.lmsorder] int,\n\t[WB_delivery.lng] float,\n\t[WB_delivery.manualdebriefreason] nvarchar(4000),\n\t[WB_delivery.mergeid] bigint,\n\t[WB_delivery.mode] nvarchar(4000),\n\t[WB_delivery.numprcls] int,\n\t[WB_delivery.optimizedorder] int,\n\t[WB_delivery.orderid] int,\n\t[WB_delivery.orderref] nvarchar(4000),\n\t[WB_delivery.orvcode] int,\n\t[WB_delivery.outofgeofencereason] nvarchar(4000),\n\t[WB_delivery.partialmatch] int,\n\t[WB_delivery.placeid] nvarchar(4000),\n\t[WB_delivery.poddistancefromdeliverypoint] float,\n\t[WB_delivery.podlaterdate] nvarchar(4000),\n\t[WB_delivery.podmanualdate] bigint,\n\t[WB_delivery.province] nvarchar(4000),\n\t[WB_delivery.reviseddebrief] int,\n\t[WB_delivery.seal] nvarchar(4000),\n\t[WB_delivery.skipdate] bigint,\n\t[WB_delivery.skipreason] nvarchar(4000),\n\t[WB_delivery.status] nvarchar(4000),\n\t[WB_delivery.submanualdebriefreason] nvarchar(4000),\n\t[WB_delivery.timedefinite] int,\n\t[WB_delivery.town] nvarchar(4000),\n\t[WB_delivery.trackingcode] nvarchar(4000),\n\t[WB_delivery.tsentergeofenceapp] bigint,\n\t[WB_delivery.tsexitgeofenceapp] bigint,\n\t[WB_delivery.tsgeofenceenter] nvarchar(4000),\n\t[WB_delivery.tspodsignature] nvarchar(4000),\n\t[WB_delivery.tsscanningstart] nvarchar(4000),\n\t[WB_delivery.tsscanningstop] nvarchar(4000),\n\t[WB_delivery.uncanceldate] bigint,\n\t[WB_delivery.uncancelusername] nvarchar(4000),\n\t[WB_delivery.vaid] bigint,\n\t[WB_delivery.verified] int,\n\t[WB_delivery.what3words] nvarchar(4000),\n\t[WB_delivery.zipcode] nvarchar(4000),\n\t[WB_dispatch.id] bigint,\n\t[WB_dispatch.lmsid] bigint,\n\t[WB_Exception] int\n\t)\n\tWITH (\n\tLOCATION = 'DataLake/Structured/Facts/T_WAYBILL.parquet',\n\tDATA_SOURCE = [synapse_citylogisticsstorage_dfs_core_windows_net],\n\tFILE_FORMAT = [SynapseParquetFormat]\n\t)\nGO\n\n\nSELECT TOP 100 * FROM dbo.F_Waybill\nGO",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "STOPS",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}